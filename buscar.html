<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Buscar</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">ORDENADOR POLICIAL</div>
        <button onclick="location.href='menu.html'" class="btn-logout">Volver</button>
    </nav>
    <div class="main-container">
        <h3>BASE DE DATOS</h3>
        <div class="search-box">
            <input type="text" id="busqueda" placeholder="DNI exacto...">
            <button class="btn-blue" onclick="buscar()">BUSCAR</button>
        </div>
        <div id="res"></div>
    </div>
    <script type="module">
        import { db } from './firebase.js';
        import { collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
        
        window.buscar = async function() {
            const val = document.getElementById('busqueda').value;
            const q = query(collection(db, "ciudadanos"), where("dni", "==", val));
            const snap = await getDocs(q);
            const div = document.getElementById('res');
            div.innerHTML = "";
            if(snap.empty) {
                div.innerHTML = "<p>Sin resultados.</p>";
            } else {
                snap.forEach(doc => {
                    const d = doc.data();
                    div.innerHTML = `<div class="dni-card-visual"><img src="${d.foto}" class="dni-photo"><div><h3>${d.nombre}</h3><p>DNI: ${d.dni}</p><p>${d.nac} - ${d.gen}</p></div></div>`;
                });
            }
        }
    </script>
</body>
</html>
